<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="../../css/style.css">
    <!-- <link rel="stylesheet" href="../../css/bnk_met/bnk_met_010100_list.css">     -->
</head>
<body>
    <div class="content_container">
        <!-- 검색 옵션 팝업-->
        <div class="searchmodal-container">
            <div class="close-search-popup" id="close-search-popup" ><img src="../../img/Filled.png"></div>
                    <table class="searchmodal_table">
                        <tr>
                            <th>OS</th>
                            <td>
                                <!-- <div class="radio-group"> -->
                                    <label class="radio-container">
                                        <input type="radio" name="os" value="all" id="saerch_all" checked>
                                        <span class="radio-label"></span>전체
                                    </label>
                                    <label class="radio-container">
                                        <input type="radio" name="os" value="iphone" id="saerch_iphone">
                                        <span class="radio-label"></span>아이폰
                                    </label>
                                    <label class="radio-container">
                                        <input type="radio" name="os" value="android" id="saerch_android">
                                        <span class="radio-label"></span>안드로이드
                                    </label>
                                <!-- </div> -->
                            </td>
                            </tr>
                        <tr>
                            <th>메뉴구분</th>
                            <td>
                                <div class="dropdown-container">
                                    <select class="dropdown-select">
                                        <option value="전체">전체</option>
                                        <option value="앱">앱</option>
                                        <option value="메뉴">메뉴</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                    </table>                
        </div>
        <!-- 순서변경 팝업 -->
        <div class="modal-background" id="modal_1">
            <div class="modal-container">
                <div class="modal-top">
                    <h2 class="modal-title-text">앱메뉴메타관리</h2>
                    <img id="close-modal-popup_1" class="close-modal-popup" src="../../img/Filled.png">
                </div>
                <div class="modal-content-container">
                    <div class="modal-content-sub-container">
                        <div class="modal-search">
                            <div class="select-group">
                                <div class="dropdown-container">
                                    <select class="dropdown-select">
                                        <option value="플랫폼">플랫폼</option>
                                        <option value="아이폰">아이폰</option>
                                        <option value="안드로이드">안드로이드</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <select class="dropdown-select">
                                        <option value="전체">메뉴구분</option>
                                        <option value="앱">앱</option>
                                        <option value="메뉴">메뉴</option>
                                    </select>
                                </div>
                            </div>
                            <button class="modal-search-button">검색</button>
                        </div>
                            <div class="modal-content">
                                <div class="modal-comment">
                                    * 이동하실 경로의 메뉴 선택 후 저장 시 이동됩니다.
                                </div>
                                <div class="modal-list-line">
                                    <div class="modal-list">
                                        <div class="modal-item-list">c_available_service(서비스여부)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_reason(서비스 불가 이유)
                                            <img src="../../img/dragable.svg">
                                        </div>
                                        <div class="modal-item-list">c_session_time(세션타입아웃)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_app_version(현재APP버전)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_search_yn(통합검색사용여부)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_act(서비스 불가 대응방법)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_act(서비스 불가 대응방법)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_act(서비스 불가 대응방법)<img src="../../img/dragable.svg"></div>
                                        <div class="modal-item-list">c_act(서비스 불가 대응방법)<img src="../../img/dragable.svg"></div>
                                    </div>
                                </div>
                            </div>
                        
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="banner-save-button-active" onclick="updatepage()">이동 배너 저장</button>
                </div>
            </div>
        </div>
        <!-- 빈내용팝업 -->
        <div class="modal-background" id="modal_2">
            <div class="modal-container">
                <div class="modal-top">
                    <h2 class="modal-title-text">앱메뉴메타관리</h2>
                    <img id="close-modal-popup_2" class="close-modal-popup" src="../../img/Filled.png">
                </div>
                <div class="modal-content-container">
                    <div class="modal-content-sub-container">
                        <div class="modal-search">
                            <div class="select-group">
                                <div class="dropdown-container">
                                    <select class="dropdown-select">
                                        <option value="플랫폼">플랫폼</option>
                                        <option value="아이폰">아이폰</option>
                                        <option value="안드로이드">안드로이드</option>
                                    </select>
                                </div>
                                <div class="dropdown-container">
                                    <select class="dropdown-select">
                                        <option value="전체">메뉴구분</option>
                                        <option value="앱">앱</option>
                                        <option value="메뉴">메뉴</option>
                                    </select>
                                </div>
                            </div>
                            <button class="modal-search-button">검색</button>
                        </div>
                            <div class="modal-content">
                                <div class="modal-comment">
                                    * 이동하실 경로의 메뉴 선택 후 저장 시 이동됩니다.
                                </div>
                                <div class="modal-list-line">
                                    <div class="modal-list">
                                        <a href="#">조회된 결과가 없습니다.</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
                <div class="modal-buttons">
                    <button class="banner-save-button" onclick="updatepage()">이동 배너 저장</button>
                </div>
            </div>
        </div>
        <div class="main_contents">
            <div class="main_inner_container">
                <div class="top_container">
                    <div class="search_bar">
                        <input type="text" id="searchInput" placeholder="메뉴속성명, 메뉴속성ID">
                        <button type="button" class="searchButton" onclick="select_list(document.getElementById('searchInput').value)">검색</button>
                        <button type="button" class="searchFilter" onclick="open_option()"></button>
                    </div>
                    <div class="file_io_container">
                        <button type="button" onclick="file_download()"><span>일괄</span> <img src="../../img/download.svg"></button>
                        <button type="button" onclick="file_upload()">일괄 <img src="../../img/upload.svg"></button>
                    </div>
                </div>
                <div class="table_container">
                    <div class="table_list_container">
                        <table class="table_list">
                            <thead>
                                <tr>
                                    <th style="width: 6%;">번호</th>
                                    <th style="width: 20%;">메뉴속성ID</th>
                                    <th style="width: 27%;">메뉴속성명</th>
                                    <th style="width: 12%;">OS</th>
                                    <th style="width: 9%;">메뉴구분</th>
                                    <th style="width: 9%;">리소스</th>
                                    <th style="width: 9%;">내부관리</th>
                                    <th style="width: 9%;">필수여부</th>
                                </tr>
                            </thead>
                            <tbody class="cell_width"><tr>
                                <td>1</td>
                                <td>bit_trn_000000_1</td>
                                <td>이체</td>
                                <td>아이폰</td>
                                <td>앱</td>
                                <td>사용</td>
                                <td style="color: var(--semantic-negative, #EE473D);">미사용</td>
                                <td>사용</td>
                            </tr><tr>
                                <td>2</td>
                                <td>cmc_bcs_010000_1</td>
                                <td>뱅크사인 이용신청</td>
                                <td>안드로이드</td>
                                <td>메뉴</td>
                                <td style="color: var(--semantic-negative, #EE473D);">미사용</td>
                                <td>사용</td>
                                <td>사용</td>
                            </tr><tr>
                                <td>3</td>
                                <td>cmc_bcs_040000_1</td>
                                <td>뱅크사인 인증수단관리</td>
                                <td>아이폰</td>
                                <td>메뉴</td>
                                <td>사용</td>
                                <td>사용</td>
                                <td style="color: var(--semantic-negative, #EE473D);">미사용</td>
                            </tr></tbody>
                        </table>
                    </div>
                    <div class="table_btn_container">
                        <div class="btn_containers">
                        <button type="button" class="change_btn" id="change_btn1" onclick="changepage()">(내용팝업)순서변경</button>
                        <button type="button" class="change_btn" id="change_btn2" onclick="changepage2()">(빈내용팝업)순서변경</button>
                    </div>
                        <div class="pagination" id="pagination">
                            <button>&lt;&lt;</button>
                            <button>&lt;</button>
                            <button class="active">1</button>
                            <button>2</button>
                            <button>3</button>
                            <button>4</button>
                            <button>5</button>
                            <button>6</button>
                            <button>&gt;</button>
                            <button>&gt;&gt;</button>
                        </div>
                        <button type="button" class="regist_btn" id="regist_btn">등록</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const searchmodal = document.querySelector('.searchmodal-container')

        document.getElementById('close-search-popup').addEventListener('click', () => {
            searchmodal.style.display = 'none';
        });

        document.getElementById('close-modal-popup_1').addEventListener('click', () => {
            modalBackground1.style.display = 'none';
        });

        document.getElementById('close-modal-popup_2').addEventListener('click', () => {
            modalBackground2.style.display = 'none';
        });

        function open_option(){
            searchmodal.style.display = 'block';
        }
        
        let draggedList = null;
        const itemList = document.querySelectorAll('.modal-item-list');

       
        // 오른쪽 패널에 이미 존재하는 버튼들이 드래그 가능하도록 설정
        itemList.forEach(item => {
            item.addEventListener('dragstart', (e) => {
                draggedList = item;
                setTimeout(() => item.style.opacity = '0.5', 0); // 드래그 시작 시 버튼이 반투명해짐
            });

            item.addEventListener('dragend', () => {
                setTimeout(() => {
                    item.style.opacity = '1';
                    draggedList = null;
                }, 0);
            });

            item.addEventListener('dragover', (e) => {
                e.preventDefault();
                const currentItem = e.target;
                if (currentItem.classList.contains('modal-item-list') && currentItem !== draggedList) {
                    const bounding = currentItem.getBoundingClientRect();
                    const offset = bounding.y + bounding.height / 2;
                    if (e.clientY - offset > 0) {
                        currentItem.parentElement.insertBefore(draggedList, currentItem.nextSibling);
                    } else {
                        currentItem.parentElement.insertBefore(draggedList, currentItem);
                    }
                }
            });
        });


        const modalBackground1 = document.getElementById('modal_1');
        const modalBackground2 = document.getElementById('modal_2');

        document.getElementById('regist_btn').addEventListener('click', () => {
            alert("등록");
        });

        function changepage(){
            modalBackground1.style.display = 'flex';
        }

        function changepage2(){
            modalBackground2.style.display = 'flex';
        }

        const table = document.querySelector('.table_list');
    
        
        //현재 페이지 데이터출력
        function displayData() {
    
            const dataBody = document.querySelector('.table_list tbody');
            dataBody.innerHTML = '';
        
            if (filteredDataList == null) return;
        
            for (let i = 0; i < totalItems; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${filteredDataList[i].number}</td>
                    <td>${filteredDataList[i].menu_id}</td>
                    <td>${filteredDataList[i].menu_name}</td>
                    <td>${filteredDataList[i].os}</td>
                    <td>${filteredDataList[i].menutype}</td>
                    <td style="${filteredDataList[i].resource === '미사용' ? 'color: var(--semantic-negative, #EE473D);' : ''}">${filteredDataList[i].resource}</td>
                    <td style="${filteredDataList[i].manage === '미사용' ? 'color: var(--semantic-negative, #EE473D);' : ''}">${filteredDataList[i].manage}</td>
                    <td style="${filteredDataList[i].essential === '미사용' ? 'color: var(--semantic-negative, #EE473D);' : ''}">${filteredDataList[i].essential}</td>
                `;
                dataBody.appendChild(row);
            }
        }
        
        // 테이블 행 클릭 이벤트 리스너 추가
        table.addEventListener('click', (event) => {
            const target = event.target;
        
            // 클릭된 요소가 <td> 태그인지 확인
            if (target.tagName === 'TD') {
                // 클릭된 <td> 태그의 부모 요소(<tr>) 가져오기
                const row = target.parentElement;
        
                // 두 번째 <td> 태그(메뉴ID)의 텍스트 내용 가져오기
                const menuId = row.cells[1].textContent;
        
                // 메뉴ID 값을 사용하여 다른 함수 호출
                handleRowClick(menuId);
            }
        });
        
        // 행 클릭 시 실행될 함수
        function handleRowClick(menuId) {
            alert(`메뉴ID: ${menuId}`);
        }
        
        jsonDataList = [
            {"number":1, "menu_id":"bit_trn_000000_1", "menu_name":"이체",               "os":"아이폰", "menutype":"앱", "resource":"사용","manage":"미사용",  "essential":"사용"},
            {"number":2, "menu_id":"cmc_bcs_010000_1", "menu_name":"뱅크사인 이용신청",   "os":"안드로이드", "menutype":"메뉴",  "resource":"미사용", "manage":"사용", "essential":"사용"},
            {"number":3, "menu_id":"cmc_bcs_040000_1", "menu_name":"뱅크사인 인증수단관리","os":"아이폰" ,"menutype":"메뉴","resource":"사용", "manage":"사용",  "essential":"미사용"}         
        ]
        
        function select_list(searchstring) {
            alert('검색');
            if (searchstring) {
                filteredDataList = jsonDataList.filter(item => {
                    const searchLower = searchstring.toLowerCase();
                    return item.menu_id.toLowerCase().includes(searchLower) || item.menu_name.toLowerCase().includes(searchLower);
                });
            } else {
                filteredDataList = jsonDataList; // 검색 조건이 없으면 전체 데이터 사용
            }
        
            totalItems = filteredDataList.length;
            displayData(); // 필터링된 결과를 표시
        }
        
        function file_download()
        {
            alert('file_down');
        }
        
        function file_upload()
        {
            const dataBody = document.querySelector('.table_list tbody');
            dataBody.innerHTML = '';
            alert('file_upload');
        }
        
        function updatepage()
        {
            alert('이동배너 저장');
        }
    
        </script>    
</body>
</html>
